<h3><i> Assignment 15A - Dataset creation for Monocular Depth Estimation Model </i></h3>
<hr>
<h4> Dataset Link </h4>
<p>Here's the drive link to the data -   
  
  [Click here to access dataset](https://drive.google.com/drive/folders/1uAsyblbBx3APE6TkcgwVbXvdeybQXge9?usp=sharing)

</p>
<h6>Contents</h6>
<ul>
  <li>Foregound images - (Folder name - fgscaled)</li>
  <li>Background images - (bf scaled)</li>
  <li>Foreground-Background - (bg-fg-images)</li>
  <li>Fg-bg masks - (bg-fg_images_masks)</li>
  <li>Depth masks - (Depth_output)</li>
</ul>
 
<hr>
<h4> Dataset statistics </h4>
<h5> Data used for foreground and background</h6>
<ol>
  <li><b>Background images</b> - Mall interiors, Highway scenes, Street locales</li>
  <li><b>Foreground images</b> - Dogs</li>
</ol>

<h5> Image count for FG, BG, FG-BG and their masks</h5>
<ol>
  <li><b>Background Images</b> - 107</li>
  <li><b>Foreground Images</b> - 100</li>
  <li><b>Fg-bg images</b> - 428000</li>
  <li><b>Fg-bg masks</b> - 428000</li>
  <li><b>Fg-bg Depth masks</b> - 428000</li>
</ol>

<h5> Size of images for each category and final dataset size</h4>
<ol>
  <li><b>Background Images</b> - 224*224</li>
  <li><b>Foreground Images</b> - 100*100</li>
  <li><b>Fg-bg images/masks/depth masks</b> - 224*224 </li>
  <li><b>Final dataset size</b> - 428k images - 5.7GB </li>
</ol>
<hr>
<h5> Mean and Standard deviation </h4>
<ol>
  <li><b>FG-BG Images-</b> <br>
    <B>Mean</b> - '0.517005503177643', '0.505432009696960', '0.487791448831558'<br>
    <b>STD</b> -  '0.229048311710358', '0.227772325277328', '0.242317050695419'</li>
  <li><b>FG-BG Masks-</b><br>
    <b>Mean</b> - '0.051495332270861', '0.051495332270861', '0.051495332270861'<BR>
    <b>STD</b>  - '0.214586526155472', '0.214586526155472', '0.214586526155472'</li>
  <li><b>Depth Masks-</b><br>
    <b>Mean</b> - '0.374479949474335', '0.374479949474335', '0.374479949474335'<BR>
    <b>STD</b>  - '0.210883036255836', '0.210883036255836', '0.210883036255836'</li>
</ol>
<hr>
<h4> Sample Images in the Dataset and their generated masks</h4>

<b><i> Foreground images</b>

![img](https://github.com/SID-SURANGE/EVA-4.0/blob/master/Session%2015%20RCNN/Assignment%2015A/Bg_images.png)

<b><i> Background images</b>

![img](https://github.com/SID-SURANGE/EVA-4.0/blob/master/Session%2015%20RCNN/Assignment%2015A/Fg_images.png)

<b><i> Foreground-Background Overlap images</b>

![img](https://github.com/SID-SURANGE/EVA-4.0/blob/master/Session%2015%20RCNN/Assignment%2015A/Fg-bg.png)

<b><i> Foreground-Background Mask images</b>

![img](https://github.com/SID-SURANGE/EVA-4.0/blob/master/Session%2015%20RCNN/Assignment%2015A/Fg-bg-mask.png)

<b><i> Foreground-Background DEPTH Mask images</b>

![img](https://github.com/SID-SURANGE/EVA-4.0/blob/master/Session%2015%20RCNN/Assignment%2015A/Depth-masks.png)

<hr>
<h4> How dataset was created</h4>
<ul>
  <li><b>Fg transparency</b> - The foreground images were made transparent using GIMP tool by working on alpka channel. Also a online website Remove-bg helped alot</li>
  <li><b>Masks for Foreground</b> - We created a black image with size similar to foreground and then placed foreground on top. After that we removed the non-zero pixels to get the masks as required.</li>
  <li><b>FG-BG Overlay images</b> - Each background was being read once and then all foregrounds were applied to same background individually at 20 different random positions. Such that in total each background had 4000 images with different fg at different position. Total time taken 2 hours to create 428k fg-bg and 428k fg-bg masks</li>
  <li><b>Depth Masks</b> -  Each Depth Mask was generated by passing sets of same background images(4k images) and then processing them and create their depth masks with model trained on NYU dataset. It took 107 iteration to create 428k depth masks since the colab memory issue was a constant problem</li>
</ul>

<h4> Code Notebooks</h4>
<ul>
  <li>Foreground-background dataset creation -https://github.com/SID-SURANGE/EVA-4.0/blob/master/Session%2015%20RCNN/Assignment%2015A/Assignment15A.ipynb </li>
  <li>Mean-Standard Deviation - https://github.com/SID-SURANGE/EVA-4.0/blob/master/Session%2015%20RCNN/Assignment%2015A/DepthModel_MeanStd.ipynb </li>
  <li>Data Visulization - https://github.com/SID-SURANGE/EVA-4.0/blob/master/Session%2015%20RCNN/Assignment%2015A/DepthModel_DataViz.ipynb</li>
  <li> Depth Masks - https://github.com/SID-SURANGE/EVA-4.0/blob/master/Session%2015%20RCNN/Assignment%2015A/DenseDepth1.ipynb</li>
</ul>
  
<hr>
Group -Siddharth Surange, Pratik Jain

